import{m as $,a as X}from"./index-49209257.js";import{B as k,d as Y,r as f,q as Z,a as C,c as ee,b as e,w as l,f as i,h as y,i as s,C as ae,e as S,t as B,u as v,E as w,D as te,_ as le}from"./index-96dae895.js";import"./mock-357df37a.js";const ne={total:0,currentPage:1,pageSizes:[10,20,50],pageSize:10,layout:"total,sizes,prev,pager,next,jumper"};function oe(D={}){const r=k(Object.assign({...ne},D));return{paginationData:r,handleCurrentChange:_=>{r.currentPage=_},handleSizeChange:_=>{r.pageSize=_}}}const se={class:"app-content"},re={class:"table-wrapper"},ue={class:"opertion"},ie={class:"search"},ce={class:"addDel"},de={class:"pager-wrapper"},pe=Y({__name:"table-one-page",setup(D){const r=f(!1),g=f(!1),h=f(!1),_=f(0),{paginationData:c,handleCurrentChange:U,handleSizeChange:j}=oe(),u=f([]),z=f([]),x=f(),O=k({username:[{required:!0,trigger:"red",message:"请输入姓名"}],phone:[{required:!0,trigger:"red",message:"请输入电话号码"}]}),o=k({username:"",phone:""}),d=k({username:"",phone:""}),q=()=>{g.value=!0},E=(n,a)=>{g.value=!0,h.value=!0,_.value=n,o.username=a.username,o.phone=a.phone},I=n=>{u.value.splice(n,1)},N=n=>{z.value=n},R=()=>{if(!z.value.length){w.error("请先选择要删除的数据");return}u.value=u.value.filter(n=>z.value.every(a=>n.id!=a.id))},F=async n=>{n&&await n.validate(async a=>{if(a){if(h.value)u.value[_.value].username=o.username,u.value[_.value].phone=o.phone,w.success("修改数据成功");else{const b=await $(o.username,o.phone);u.value=[...b.data,...u.value],w.success("新增数据成功")}h.value=!1,g.value=!1}else return!1})},L=()=>{o.username="",o.phone="",h.value=!1},M=async()=>{if(r.value=!0,!Object.values(d).join("").length){w.error("请输入您要查询的信息"),r.value=!1;return}try{const n=await $(d.username,d.phone);c.total=1,u.value=n.data}catch(n){console.log("e",n)}finally{r.value=!1}},P=async()=>{r.value=!0;try{const n=await X();d.username="",d.phone="",c.total=n.total||100,u.value=n.list}catch(n){console.log(n)}finally{r.value=!1}};return Z([()=>c.currentPage,()=>c.pageSize],P,{immediate:!0}),(n,a)=>{const b=i("el-input"),p=i("el-button"),m=i("el-table-column"),V=i("el-tag"),A=i("el-table"),G=i("el-pagination"),H=i("el-card"),T=i("el-form-item"),J=i("el-form"),K=i("el-dialog"),Q=te("loading");return C(),ee("div",se,[e(H,null,{default:l(()=>[y("div",re,[y("div",ue,[y("div",ie,[e(b,{placeholder:"请输入姓名",class:"mr",modelValue:d.username,"onUpdate:modelValue":a[0]||(a[0]=t=>d.username=t)},null,8,["modelValue"]),e(b,{placeholder:"请输入手机",class:"mr",modelValue:d.phone,"onUpdate:modelValue":a[1]||(a[1]=t=>d.phone=t)},null,8,["modelValue"]),e(p,{type:"primary",onClick:M},{default:l(()=>[s("查询")]),_:1}),e(p,{type:"warning",onClick:P},{default:l(()=>[s("重置表格")]),_:1})]),y("div",ce,[e(p,{type:"primary",onClick:q},{default:l(()=>[s("新增数据")]),_:1}),e(p,{type:"danger",onClick:R},{default:l(()=>[s("批量删除")]),_:1})])]),ae((C(),S(A,{data:u.value,border:!0,"highlight-current-row":"",onSelectionChange:N},{default:l(()=>[e(m,{type:"selection",width:"50",align:"center"}),e(m,{prop:"username",label:"姓名",align:"center"}),e(m,{prop:"status",label:"性别",align:"center"},{default:l(t=>[e(V,{effect:"plain",type:t.row.status==="女"?"danger":""},{default:l(()=>[s(B(t.row.status),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"phone",label:"手机号",align:"center"}),e(m,{prop:"email",label:"邮箱",align:"center"}),e(m,{prop:"roles",label:"身份",align:"center"},{default:l(t=>[t.row.roles==="admin"?(C(),S(V,{key:0},{default:l(()=>[s("admin")]),_:1})):(C(),S(V,{key:1,type:"warning"},{default:l(()=>[s(B(t.row.roles),1)]),_:2},1024))]),_:1}),e(m,{prop:"createTime",label:"创建时间",align:"center"}),e(m,{label:"操作",align:"center"},{default:l(t=>[e(p,{plain:"",type:"success",size:"small",onClick:W=>E(t.$index,t.row)},{default:l(()=>[s("修改")]),_:2},1032,["onClick"]),e(p,{plain:"",type:"danger",size:"small",onClick:W=>I(t.$index)},{default:l(()=>[s("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Q,r.value]])]),y("div",de,[e(G,{background:"",layout:v(c).layout,"page-sizes":v(c).pageSizes,total:v(c).total,"page-size":v(c).pageSize,currentPage:v(c).currentPage,onSizeChange:v(j),onCurrentChange:v(U)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])]),_:1}),e(K,{modelValue:g.value,"onUpdate:modelValue":a[6]||(a[6]=t=>g.value=t),title:h.value?"修改信息":"新增用户",onClose:L,width:"36%"},{footer:l(()=>[e(p,{onClick:a[4]||(a[4]=t=>g.value=!1)},{default:l(()=>[s("取消")]),_:1}),e(p,{type:"primary",onClick:a[5]||(a[5]=t=>F(x.value))},{default:l(()=>[s("确定")]),_:1})]),default:l(()=>[e(J,{ref_key:"formRef",ref:x,model:o,rules:O,"label-width":"100px","label-position":"left"},{default:l(()=>[e(T,{prop:"username",label:"姓名"},{default:l(()=>[e(b,{modelValue:o.username,"onUpdate:modelValue":a[2]||(a[2]=t=>o.username=t),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),e(T,{prop:"phone",label:"电话"},{default:l(()=>[e(b,{modelValue:o.phone,"onUpdate:modelValue":a[3]||(a[3]=t=>o.phone=t),placeholder:"请输入电话号码"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});const fe=le(pe,[["__scopeId","data-v-b4ed97ae"]]);export{fe as default};
